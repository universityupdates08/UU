<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admit Card Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --card-bg: #ffffff;
            --ink: #111827;
        }

        /* Base Styles & Inter Font */
        html,
        body {
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
            background: #f8fafc;
            color: var(--ink);
        }

        /* Utility Classes */
        .glass {
            background: rgba(255, 255, 255, .8);
            backdrop-filter: blur(10px);
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        /* Form Layout Styles */
        h1,
        h2 {
            color: #333;
            text-align: center;
        }

        #form-container {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 900px;
            margin-bottom: 20px;
        }

        .entry-toggle {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 6px;
            overflow: hidden;
        }

        .toggle-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background-color: #f0f0f0;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            color: #555;
            transition: background-color 0.3s, color 0.3s;
        }

        .toggle-btn.active {
            background-color: #007BFF;
            color: white;
        }

        #auto-fill-section {
            text-align: center;
            padding: 20px;
            border: 2px dashed #ccc;
            border-radius: 8px;
        }

        #auto-fill-section label {
            font-weight: bold;
            font-size: 18px;
            display: block;
            margin-bottom: 15px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        .form-group input,
        .form-group select {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }

        #papers-container {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        /* Paper Entry Grid for responsiveness (FIXED to prevent unnecessary stacking) */
        .paper-entry {
            /* FIX: Use flexible units (fr) to make columns adapt automatically.
               Paper Code (1fr), Paper Name (3fr), Paper Type (1.5fr), Remove Button (40px fixed) */
            display: grid;
            grid-template-columns: 1fr 3fr 1.5fr 40px;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
        }

        @media (max-width: 900px) {
            .paper-entry {
                /* Adjust ratio slightly for medium screens */
                grid-template-columns: 1fr 2.5fr 1.5fr 40px; 
            }
        }

        @media (max-width: 640px) {
            .paper-entry {
                /* Stack on small screens for form inputs to be readable */
                grid-template-columns: 1fr;
                gap: 5px;
            }

            .paper-entry button {
                width: 100%;
            }
        }


 
/* Dropdown positioning */
    nav { position: relative; z-index: 50; }
    nav .group:hover div { display: block !important; z-index: 60; }
    
        /* Gradient Button Styles */
        .gradient-button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .gradient-button:hover {
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
            transform: translateY(-1px);
        }

        #generateBtn {
            background-image: linear-gradient(to right, #1E3A8A, #3B82F6);
        }

        #generateBtn:hover {
            background-image: linear-gradient(to right, #1D4ED8, #2563EB);
        }

        #downloadBtn {
            background-image: linear-gradient(to right, #10B981, #059669);
        }

        #downloadBtn:hover {
            background-image: linear-gradient(to right, #06B6D4, #14B8A6);
        }

        #printBtn {
            background-image: linear-gradient(to right, #9333EA, #A855F7);
        }

        #printBtn:hover {
            background-image: linear-gradient(to right, #7C3AED, #8B5CF6);
        }

        #resetBtn {
            background-image: linear-gradient(to right, #EF4444, #F97316);
        }

        #resetBtn:hover {
            background-image: linear-gradient(to right, #DC2626, #F97316);
        }


        /* Admit Card Styles */
        #admit-card-wrapper {
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
            padding: 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        #admit-card-content {
            border: 2px solid black;
            padding: 15px;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 2px solid black;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        .header img {
            height: 60px;
            width: auto;
        }

        .header h3 {
            flex: 1;
            text-align: center;
            margin: 0;
            font-size: 20px;
        }

        .header-right {
            width: 60px;
        }

        .sub-header {
            text-align: center;
            font-weight: bold;
            padding: 5px 0;
            margin-bottom: 10px;
        }

        .sub-header h4 {
            margin: 0;
            padding: 5px 10px;
            border: 1px solid black;
            border-radius: 5px;
            display: inline-block;
        }

        .details-table {
            width: 100%;
            margin-top: 10px;
            border-collapse: collapse;
        }

        .details-table td {
            padding: 5px;
            font-size: 14px;
            vertical-align: top;
        }

        .details-table .label {
            font-weight: bold;
            width: 25%;
        }

        /* FIX: Paper Table Widths for better print layout */
        .papers-table {
            width: 100%;
            margin-top: 15px;
            border-collapse: collapse;
            font-size: 12px;
            /* Ensure fixed layout for consistent column widths */
            table-layout: fixed; 
        }

        .papers-table th,
        .papers-table td {
            border: 1px solid black;
            padding: 6px;
            text-align: left;
            word-wrap: break-word; /* Allows long names to wrap */
        }

        .papers-table th {
            background-color: #f2f2f2;
            text-align: center;
            font-weight: bold;
        }
        
        /* FIX: Re-enforce column widths using percentages for automatic device/print sizing */
        .papers-table th:nth-child(1), .papers-table td:nth-child(1) { width: 5%; text-align: center; }  /* S. No. - Center aligned */
        .papers-table th:nth-child(2), .papers-table td:nth-child(2) { width: 12%; } /* PAPER CODE */
        .papers-table th:nth-child(3), .papers-table td:nth-child(3) { width: 30%; } /* PAPER NAME (Increased width) */
        .papers-table th:nth-child(4), .papers-table td:nth-child(4) { width: 13%; } /* PAPER TYPE */
        .papers-table th:nth-child(5), .papers-table td:nth-child(5) { width: 12%; } /* EXAM DATE */
        .papers-table th:nth-child(6), .papers-table td:nth-child(6) { width: 8%; } /* DAY (Reduced width) */
        .papers-table th:nth-child(7), .papers-table td:nth-child(7) { width: 20%; } /* SHIFT */


        .footer-note {
            font-size: 12px;
            margin-top: 10px;
            font-weight: bold;
        }

        /* Improved Printed Date/Time Display */
        #generatedTime {
            font-size: 11px;
            font-style: italic;
            color: #4B5563;
            /* Darker gray for better print contrast */
            padding-top: 10px;
            border-top: 1px dashed #D1D5DB;
        }

        /* Print-specific styles to hide elements */
        @media print {
            body>*:not(#admit-card-wrapper) {
                display: none !important;
            }

            #admit-card-wrapper {
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
                max-width: 100% !important;
                width: 100% !important;
            }

            #admit-card-content {
                border: 1px solid black !important;
                margin: 0;
                padding: 10px;
            }
        }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
    </script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
</head>
<body class="flex flex-col items-center">
    <header class="w-full border-b bg-white/70 sticky top-0 z-30 shadow-lg">
        <div class="max-w-6xl mx-auto flex items-center justify-center p-4">
            <div class="flex items-center gap-3">
                <img src="https://i.ibb.co/nMC0877T/UNIVERSITY-UPDATES-LOGO-removebg-preview.png" alt="Logo" class="h-10 w-auto" />
            </div>
              </div> 
       


 <nav class="bg-[#800000] text-white">
    <div class="max-w-6xl mx-auto flex items-center justify-center p-1">
      <div class="flex justify-between items-center py-1">
        <div class="hidden md:flex items-center space-x-3 text-sm font-small">
          <a href="index.html" class="hover:text-yellow-300">Home</a>
          <span class="mx-2">|</span>

          <a href="https://t.me/CCSUniversityMRT" class="hover:text-yellow-300">Telegram</a>
          <span class="mx-2">|</span>

          <a href="https://www.youtube.com/@University-Updates-UU" class="hover:text-yellow-300">YouTube</a>
          <span class="mx-2">|</span>
          
          <a href="https://www.instagram.com/@UniversityUpdates_UU" class="hover:text-yellow-300">Instagram</a>
          <span class="mx-2">|</span>
          
          <a href="https://www.whatsapp.com/channel/0029Va9jtav4tRrmKPxos138" class="hover:text-yellow-300">Whatsapp</a>
          <span class="mx-2">|</span>


          <a href="https://t.me/HelpforDmbot" class="hover:text-yellow-300">Contact Us</a>
        </div> </div> 
        
        <div class="md:hidden">
          <button id="menu-btn" class="focus:outline-none text-2xl">☰</button>
        </div>     
      </div> 


      <div id="mobile-menu" class="hidden md:hidden bg-[#800000] text-white px-4 pb-3 space-y-2">
        <a href="#index.html" class="block hover:text-yellow-300">Home</a>

        <a href="https://t.me/CCSUniversityMRT" class="block hover:text-yellow-300">Telegram</a>
        <a href="https://www.youtube.com/@University-Updates-UU" class="block hover:text-yellow-300">YouTube</a>
        <a href="https://www.instagram.com/@UniversityUpdates_UU" class="block hover:text-yellow-300">Instagram</a>
        <a href="https://www.whatsapp.com/channel/0029Va9jtav4tRrmKPxos138" class="block hover:text-yellow-300">Whatsapp</a>

     
        <a href="https://t.me/HelpforDmbot" class="block hover:text-yellow-300">Contact Us</a>
      </div>
       
  </nav>
    </header> 
  
     
  
  
<h1 class="mt-3 mx-auto text-3xl font-extrabold text-center text-gray-800">ADMIT CARD GENERATOR</h1>


<div class="flex justify-center mt-6 px-2">
  <div class="w-full max-w-sm sm:max-w-md md:max-w-3xl mx-auto text-center bg-gradient-to-r from-blue-50 to-blue-100 shadow-lg border border-blue-300 rounded-lg p-4 sm:p-6">
    <div class="flex justify-center items-center gap-2 sm:gap-3 mb-2">
      <img src="https://cdn-icons-png.flaticon.com/512/595/595067.png" 
           alt="Disclaimer Icon" 
           class="h-6 w-6 sm:h-8 sm:w-8">
      <h2 class="text-base sm:text-lg md:text-xl font-bold text-blue-800">HOW TO USE?</h2>
    </div>
    <p class="text-[10px] sm:text-sm text-gray-700 leading-relaxed mb-1">
      <b>Step 1:</b> Fill the Manual Entry according to Exam Form.
    </p>  
    <p class="text-[10px] sm:text-sm text-gray-700 leading-relaxed mb-1"><b>OR</b></p>
    <p class="text-[10px] sm:text-sm text-gray-700 leading-relaxed mb-1">
      <b>Step 2:</b> Upload your Exam Form/Admit Card (PDF Recommended)
    </p>
    <p class="text-[10px] sm:text-sm text-gray-700 leading-relaxed mb-1">
      (a) Verify your details. If any error seems then correct it manually.
    </p>
    <p class="text-[10px] sm:text-sm text-gray-700 leading-relaxed">
      (b) Click on Generate Admit Card.
    </p>
  </div>
</div>


    <div id="form-container" class="mt-5 mx-auto bg-white rounded-xl shadow-lg p-8 w-full max-w-5xl">
        
        <div class="entry-toggle flex justify-center mb-8">
            <button class="toggle-btn active rounded-l-md" id="manualBtn">Manual Entry</button>
            <button class="toggle-btn rounded-r-md" id="autoBtn">Auto-fill from Upload</button>
        </div>

        <div id="auto-fill-section" style="display:none;" class="border-2 border-dashed border-blue-300 bg-blue-50 p-6 rounded-lg text-center mb-8">
            <label for="admitCardUpload" class="block text-lg font-semibold text-blue-700 mb-3">
                Upload Admit Card/Exam Form (PDF/Image) to Auto-Fill Details (PDF Recommended)
            </label>
            <input type="file" id="admitCardUpload" accept=".pdf,.png,.jpg,.jpeg" class="p-2 border border-gray-300 rounded-md w-full max-w-md mx-auto block">
            <p id="upload-status" class="mt-3 text-blue-600 font-semibold"></p>
        </div>

        <div id="manual-form">
            <form id="admitCardForm" class="space-y-8">

                <div>
                    <h2 class="text-xl font-semibold mb-4 border-b-2 border-gray-300 pb-2 text-gray-700">Student Details</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                        <div class="form-group">
                            <label for="candidateName">Candidate Name:</label>
                            <input type="text" id="candidateName" required>
                        </div>
                        <div class="form-group">
                            <label for="fatherMotherName">Father's/Mother's Name:</label>
                            <input type="text" id="fatherMotherName" required>
                        </div>
                        <div class="form-group">
                            <label for="rollNumber">Roll Number:</label>
                            <input type="text" id="rollNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="enrollmentNumber">Enrollment Number:</label>
                            <input type="text" id="enrollmentNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="course">Course:</label>
                            <input type="text" id="course" required>
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender:</label>
                            <select id="gender" required>
                                <option value="">Select</option>
                                <option value="FEMALE">FEMALE</option>
                                <option value="MALE">MALE</option>
                                <option value="OTHER">OTHER</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="semester">Semester:</label>
                            <select id="semester" required>
                                <option value="">Select Semester</option>
                                <option value="1">1st</option>
                                <option value="2">2nd</option>
                                <option value="3">3rd</option>
                                <option value="4">4th</option>
                                <option value="5">5th</option>
                                <option value="6">6th</option>
                                <option value="7">7th</option>
                                <option value="8">8th</option>
                                <option value="9">9th</option>
                                <option value="10">10th</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="examType">Exam Type:</label>
                            <select id="examType" required>
                                <option value="">Select Exam Type</option>
                                <option value="MAIN EXAM">Main</option>
                                <option value="BACK EXAM">Back</option>
                                <option value="EX-STUDENT EXAM">Ex-Student</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="collegeName">College Name:</label>
                            <input type="text" id="collegeName" required>
                        </div>
                        <div class="form-group">
                            <label for="examinationCenter">Examination Center:</label>
                            <input type="text" id="examinationCenter" required>
                        </div>
                        <div class="form-group">
                            <label for="subject">Main Subject:</label>
                            <input type="text" id="subject" required>
                        </div>
                    </div>
                </div>

                <div id="papers-container">
                    <h2 class="text-xl font-semibold mb-4 border-b-2 border-gray-300 pb-2 text-gray-700">Paper Details</h2>
                    <div id="paper-entries" class="space-y-3"></div>
                    <div class="text-center mt-4">
                        <button type="button" id="addPaperBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white text-sm py-2 px-5 rounded-full shadow-md transition">
                            + Add Paper
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    

  <div class="action-buttons flex flex-wrap justify-center gap-4 mt-6 mb-10 w-full max-w-5xl px-4">
        <button type="button" id="generateBtn" class="gradient-button">Generate Admit Card</button>
        <button type="button" id="resetBtn" class="gradient-button">Reset Form</button>
        <button type="button" id="printBtn" class="gradient-button" style="display:none;">Print Admit Card</button>
        <button type="button" id="downloadBtn" class="gradient-button" style="display:none;">Download as PDF</button>
    </div>



<div id="admit-card-wrapper" style="display:none;">
  <div id="admit-card-content">
    <div class="header">
      <img src="https://i.ibb.co/nMC0877T/UNIVERSITY-UPDATES-LOGO-removebg-preview.png">
      <h3><b>UNIVERSITY UPDATES</b></h3>
      <div class="header-right"></div>
    </div>

    <div class="sub-header" style="text-align:center; margin-bottom:10px;">
      <h4 style="font-weight:bold; font-size:16px;">
        औपबंधिक प्रवेश-पत्र / PROVISIONAL ADMIT CARD
      </h4>
    </div>
    <div class="sub-header" style="text-align:justify; margin-bottom:10px;">
      <h4 style="font-weight:bold; color:#d32f2f; font-size:16px;">
        यह प्रवेश पत्र केवल आपकी सुविधा एवं जानकारी हेतु है, परीक्षाओ के लिए यह वैध नहीं है। यह सीसीएसयू से संबद्ध या समर्थित नहीं है। वैध प्रवेश पत्र के लिए ccsuniversityweb.in पर विजिट करें। 
      </h4>
    </div>

    <p id="exam-type-sem" style="text-align:center; font-weight:bold; font-size:16px; margin-bottom:15px; color:#d32f2f;"></p>

    <table class="details-table">
      <tr>
        <td class="label">Roll Number:</td>
        <td class="value" id="ac-rollNumber"></td>
        <td class="label">Enrollment No:</td>
        <td class="value" id="ac-enrollmentNumber"></td>
      </tr>
      <tr>
        <td class="label">Candidate Name:</td>
        <td class="value" id="ac-candidateName"></td>
        <td class="label">Father's/Mother's Name:</td>
        <td class="value" id="ac-fatherMotherName"></td>
      </tr>
      <tr>
        <td class="label">Course:</td>
        <td class="value" id="ac-course"></td>
        <td class="label">Gender:</td>
        <td class="value" id="ac-gender"></td>
      </tr>
      <tr>
        <td class="label">College Name:</td>
        <td class="value" id="ac-collegeName" colspan="3"></td>
      </tr>
      <tr>
        <td class="label">Examination Center:</td>
        <td class="value" id="ac-examinationCenter" colspan="3"></td>
      </tr>
      <tr>
        <td class="label">Subject:</td>
        <td class="value" colspan="3" id="ac-subject"></td>
      </tr>
    </table>

    <table class="papers-table" id="ac-papers-table">
      <thead>
        <tr>
          <th>S. No.</th>
          <th>PAPER CODE</th>
          <th>PAPER NAME</th>
          <th>PAPER TYPE</th>
          <th>EXAM DATE</th>
          <th>DAY</th>
          <th>SHIFT</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="mt-8 text-xs text-gray-600 leading-relaxed border-t pt-4">
      <p class="text-justify"><strong>नोट:</strong> यह औपबंधिक प्रवेश पत्र आधिकारिक तौर पर स्वीकृत नहीं है। इसको बनाने का मात्र उद्देश्य सम्बन्धित छात्रों को परीक्षा तिथि और समय की जानकारी उपलब्ध कराना है। अधिक जानकारी के लिए विश्वविद्यालय की अधिकृत वेबसाइट www.ccsuniversity.ac.in का अवलोकन करें। उक्त प्रवेश पत्र विश्वविद्यालय के पत्रांक संख्या <b>परीक्षा/डी०आर०/9906</b> दिनाँक 07.11.2025 के अनुसार है।</p>


      <div class="text-right mt-2">
        <p class="text-xs text-gray-500 font-semibold">Generated On:</p>
        <p class="text-sm font-mono text-gray-800" id="generatedTime"></p>
      </div>
    </div>
  </div>
</div>

<div id="disclaimer-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-2">
    <div class="bg-white rounded-lg shadow-2xl p-3 sm:p-4 max-w-xs sm:max-w-sm md:max-w-md w-full mx-auto">
        <h2 class="text-base sm:text-sm font-bold mb-2 text-red-600 border-b pb-1 text-center">
            DISCLAIMER & IMPORTANT NOTE
        </h2>

        <p class="text-gray-700 mb-2 text-[10px] sm:text-xs leading-tight text-justify">
            This <b>ADMIT CARD GENERATOR</b> is a non-official tool designed for educational and informational purposes only. The provisional admit card generated here is based on user input and pre-defined exam datesheet data.
        </p>

        <ul class="list-disc list-inside text-gray-700 mb-2 text-[10px] sm:text-xs leading-tight space-y-1 text-justify">
            <li>The content is <b>NOT</b> officially sanctioned by any University.</li>
            <li>Always refer to the official University website for your final, legally valid admit card, exam center, and schedule.</li>
            <li>The accuracy of the generated card depends entirely on the accuracy of the data you provide or the data extracted via OCR.</li>
            <li>यह केवल परीक्षा की तिथि की जानकारी हेतु है, यह कोई आधिकारिक दस्तावेज नहीं है।</li>
        </ul>

        <p class="text-gray-800 font-semibold text-[10px] sm:text-xs text-justify">
            By clicking 'I Understand', you acknowledge that this is a mock document, and you accept full responsibility for verifying all details with the official University sources.
        </p>

        <div class="mt-3 flex justify-center">
            <button id="understand-btn" class="gradient-button bg-green-500 hover:bg-green-600 transition duration-150 px-2 py-1 text-[10px] sm:text-xs rounded">
                I Understand and Accept
            </button>
        </div>
    </div>
</div>


<script>
        // --- DATA (Datesheet for fetching Date, Day, and Shift) ---
        const examDatesheet = {
            'A040101T': {
                date: '26-Nov-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A020501T': {
                date: '26-Nov-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010101T': {
                date: '26-Nov-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B010101T': {
                date: '26-Nov-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B040101T': {
                date: '26-Nov-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A040301T': {
                date: '27-Nov-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'B010301T': {
                date: '27-Nov-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'C010301T': {
                date: '27-Nov-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B040301T': {
                date: '27-Nov-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A020502T': {
                date: '27-Nov-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A050101T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A300501T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A310501T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A320501T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A120501T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010501T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B030101T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B050101T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B058101T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B010502T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B040502T': {
                date: '28-Nov-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A050301T': {
                date: '29-Nov-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010102T': {
                date: '29-Nov-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B030301T': {
                date: '29-Nov-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B050301T': {
                date: '29-Nov-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B058301T': {
                date: '29-Nov-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A120502T': {
                date: '29-Nov-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A060101T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'E010501T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A090501T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010302T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B020101T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B030501T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B050501T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B058501T': {
                date: '01-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A060301T': {
                date: '02-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010502T': {
                date: '02-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B020301T': {
                date: '02-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A090502T': {
                date: '02-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A010101T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A180501T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A030501T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'E010502T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'C010103T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B190101T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B070101T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B050502T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B058502T': {
                date: '03-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A010301T': {
                date: '04-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010303T': {
                date: '04-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B190301T': {
                date: '04-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B070301T': {
                date: '04-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A030502T': {
                date: '04-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A180503T': {
                date: '04-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A070101T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A070102T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A070104T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'E020501T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A100501T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010503T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B080101T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B017101T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B060101T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B020501T': {
                date: '05-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A070301T': {
                date: '06-Dec-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A070302T': {
                date: '06-Dec-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A070304T': {
                date: '06-Dec-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010104T': {
                date: '06-Dec-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B080301T': {
                date: '06-Dec-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B017301T': {
                date: '06-Dec-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B060301T': {
                date: '06-Dec-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A080101T': {
                date: '08-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A210501T': {
                date: '08-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A100502T': {
                date: '08-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'E020502T': {
                date: '08-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010304T': {
                date: '08-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B020502T': {
                date: '08-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A080301T': {
                date: '09-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010504T': {
                date: '09-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B010501T': {
                date: '09-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B040501T': {
                date: '09-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A210502T': {
                date: '09-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A110101T': {
                date: '10-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A130501T': {
                date: '10-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'B190501T': {
                date: '10-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B070501T': {
                date: '10-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A110301T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A300301T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A310301T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A320301T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'C010505T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B030502T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B030503T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B030504T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A130502T': {
                date: '11-Dec-2025',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'E020101T': {
                date: '12-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A070502T': {
                date: '12-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'B190502T': {
                date: '12-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B070502T': {
                date: '12-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'E020301T': {
                date: '13-Dec-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A060501T': {
                date: '13-Dec-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'Z010101': {
                date: '15-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Z050501': {
                date: '15-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'Z030301': {
                date: '16-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10001': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10003': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10004': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10005': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10006': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10007': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10008': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10010': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10030': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10018': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10037': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10038': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10039': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10040': {
                date: '17-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10032': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10034': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10035': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10036': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10020': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10012': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10033': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q10029': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q30001': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q30002': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q30003': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'Q30004': {
                date: '18-Dec-2025',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A020101T': {
                date: '19-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A040501T': {
                date: '19-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'B080501T': {
                date: '19-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B017501T': {
                date: '19-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B060501T': {
                date: '19-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A020301T': {
                date: '20-Dec-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A040502T': {
                date: '20-Dec-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'E010101T': {
                date: '22-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'B080502T': {
                date: '22-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B017502T': {
                date: '22-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'B060502T': {
                date: '22-Dec-2025',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'E010301T': {
                date: '24-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A060502T': {
                date: '24-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A100301T': {
                date: '26-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A180101T': {
                date: '26-Dec-2025',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A010501T': {
                date: '26-Dec-2025',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A180301T': {
                date: '27-Dec-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A030301T': {
                date: '27-Dec-2025',
                day: 'Saturday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A010502T': {
                date: '27-Dec-2025',
                day: 'Saturday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A210101T': {
                date: '29-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A080501T': {
                date: '29-Dec-2025',
                day: 'Monday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A210301T': {
                date: '30-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A080502T': {
                date: '30-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A080503T': {
                date: '30-Dec-2025',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A130101T': {
                date: '31-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A110501T': {
                date: '31-Dec-2025',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A130301T': {
                date: '01-Jan-2026',
                day: 'Thursday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A110502T': {
                date: '01-Jan-2026',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A090101T': {
                date: '01-Jan-2026',
                day: 'Thursday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A100101T': {
                date: '02-Jan-2026',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A070501T': {
                date: '02-Jan-2026',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A120101T': {
                date: '02-Jan-2026',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A310101T': {
                date: '02-Jan-2026',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A320101T': {
                date: '02-Jan-2026',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A300101T': {
                date: '02-Jan-2026',
                day: 'Friday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A090301T': {
                date: '02-Jan-2026',
                day: 'Friday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A050501T': {
                date: '05-Jan-2026',
                day: 'Monday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A120301T': {
                date: '06-Jan-2026',
                day: 'Tuesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A030101T': {
                date: '07-Jan-2026',
                day: 'Wednesday',
                shift: 'Shift I (10:00 AM - 01:00 PM)'
            },
            'A050502T': {
                date: '07-Jan-2026',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A050503T': {
                date: '07-Jan-2026',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            'A050504T': {
                date: '07-Jan-2026',
                day: 'Wednesday',
                shift: 'Shift II (02:00 PM - 05:00 PM)'
            },
            
            
            // Non-scheduled / Placeholder Entries (Retained from original HTML)
            'C010403P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            }, // Practical - Date decided by college
            'A010603R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A020607R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A030607R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A040604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A050605R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A060603R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A070606R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A070603R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A080604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A090604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A090603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A100603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A100604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A110603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A110604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A120603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A120604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A130603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A130604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A180603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A180604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A210603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'A210604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'E010603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'E010604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'E020603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'E020604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B010603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B010604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B020603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B020604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B030603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B030604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B040603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B040604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B050603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B050604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B060603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'B060604R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'C010603P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'C010607R': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            },
            'Q10021': {
                date: '22-May-2025',
                day: 'Thursday',
                shift: 'Shift 1 (8:00 AM - 11:00 AM)'
            },
            'V0001015P': {
                date: 'N/A',
                day: 'N/A',
                shift: 'N/A'
            }, // Practical/Vocational
            'V0001015T': {
                date: '23-May-2025',
                day: 'Friday',
                shift: 'Shift 1 (8:00 AM - 11:00 AM)'
            }, // Assuming T means Theory
            'Z060601': {
                date: '14-Oct-2025',
                day: 'Tuesday',
                shift: 'Shift 1 (10:00 AM - 12:00 PM)'
            },
            
            // Added B010601T from Neha Sagar's form for date lookup
            'D010601T': {
                date: '06-May-2025',
                day: 'Tuesday',
                shift: 'Shift 2 (11:00 AM - 2:00 PM)'
            },
            // Added B010201T from Somiya's Admit Card
            'D010201T': {
                date: '01-May-2025',
                day: 'Thursday',
                shift: 'Shift 1 (8:00 AM - 11:00 AM)'
            },
        };

        const paperEntriesContainer = document.getElementById('paper-entries');

        // --- MODAL AND INITIALIZATION LOGIC (NEW/UPDATED) ---
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('disclaimer-modal');
            const understandBtn = document.getElementById('understand-btn');
            
            // Initially hide main content elements
            document.getElementById('form-container').style.display = 'none';
            document.querySelector('.action-buttons').style.display = 'none';
            document.getElementById('admit-card-wrapper').style.display = 'none';
            
            // Show the modal
            modal.style.display = 'flex';
            
            // Set up the Understand button click handler
            understandBtn.addEventListener('click', () => {
                modal.style.display = 'none'; // Hide modal

                // Show main content
                document.getElementById('form-container').style.display = 'block';
                document.querySelector('.action-buttons').style.display = 'flex'; 

                // Initial setup for the form (Add one paper entry)
                addPaperEntry();
            });
        });
        
        // --- TOGGLE MANUAL / AUTO MODE (NEW FUNCTION) ---
        function switchToManualMode() {
            document.getElementById('manual-form').style.display = 'block';
            document.getElementById('auto-fill-section').style.display = 'none';
            document.getElementById('manualBtn').classList.add('active');
            document.getElementById('autoBtn').classList.remove('active');
        }

        // --- TOGGLE EVENT LISTENERS (UPDATED) ---
        document.getElementById('manualBtn').addEventListener('click', switchToManualMode);

        document.getElementById('autoBtn').addEventListener('click', () => {
            document.getElementById('manual-form').style.display = 'none';
            document.getElementById('auto-fill-section').style.display = 'block';
            document.getElementById('manualBtn').classList.remove('active');
            document.getElementById('autoBtn').classList.add('active');
        });

        // --- ADD/REMOVE PAPER ROW ---
        function addPaperEntry(paper = {
            code: '',
            name: '',
            type: ''
        }) {
            const div = document.createElement('div');
            div.className = 'paper-entry';
            div.innerHTML = `
        <input type="text" placeholder="Paper Code" value="${paper.code}" required>
        <input type="text" placeholder="Paper Name" value="${paper.name}" required>
        <input type="text" placeholder="Paper Type (Theory, Practical)" value="${paper.type}" required>
        <button type="button" class="remove-paper-btn bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-1  text-xs rounded" title="Remove Paper">X</button>`;
            div.querySelector('.remove-paper-btn').addEventListener('click', () => {
                if (paperEntriesContainer.children.length > 1) {
                    paperEntriesContainer.removeChild(div);
                } else {
                    // Use a custom message instead of alert()
                    showFloatingMessage('Cannot remove the last paper entry.', 'bg-yellow-500');
                }
            });
            paperEntriesContainer.appendChild(div);
        }

        document.getElementById('addPaperBtn').addEventListener('click', () => addPaperEntry());

        // --- FILE UPLOAD + OCR EXTRACTION (Logic updated for auto-switch) ---
        document.getElementById('admitCardUpload').addEventListener('change', handleFileUpload);

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            const status = document.getElementById('upload-status');
            if (!file) return;
            status.textContent = 'Extracting text... please wait.';

            let extractedText = '';
            try {
                if (file.type === 'application/pdf') {
                    extractedText = await extractTextFromPDF(file);
                } else if (file.type.startsWith('image/')) {
                    extractedText = await extractTextFromImage(file);
                }
            } catch (e) {
                console.error('Extraction Error:', e);
                status.textContent = 'Error reading file. Check console for details.';
                return;
            }

            if (!extractedText.trim()) {
                status.textContent = 'No readable text found.';
                return;
            }

            // Try to detect common fields
            const extractedData = parseExamFormText(extractedText);
            fillFormWithData(extractedData);
            
            // *** NEW: Automatically switch to Manual Entry mode ***
            switchToManualMode();
            
            status.textContent = '✅ Data fetched successfully! Please review and verify the details below.';
        }

        async function extractTextFromPDF(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({
                data: arrayBuffer
            }).promise;
            let text = '';
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const content = await page.getTextContent();
                const strings = content.items.map(item => item.str).join(' ');
                text += strings + '\n';
            }
            return text;
        }

        async function extractTextFromImage(file) {
            const status = document.getElementById('upload-status');
            status.textContent = '🔍 Scanning image... (this may take 10–20 sec)';
            const result = await Tesseract.recognize(file, 'eng', {
                logger: info => status.textContent = `Scanning: ${Math.round(info.progress*100)}%`
            });
            return result.data.text;
        }

        /**
         * @description Extracts and cleans student and exam metadata from the provided text.
         */
        function parseExamFormText(text) {
            const cleanText = text.replace(/[\r\n]+/g, ' ').replace(/\s{2,}/g, ' ').toUpperCase();

            const getMatch = (pattern) => {
                const match = cleanText.match(pattern);
                if (match && match[1]) {
                    return match[1].trim().replace(/\s+/g, ' ');
                }
                return '';
            };

             // --- 1. EXAM TYPE FIX (More robust) ---
            let examType = 'MAIN EXAM';
            // --- MODIFICATION START (C) ---
            if (cleanText.includes('SPECIAL BACK PAPER')) {
                examType = 'BACK EXAM'; // Use BACK EXAM to select the correct dropdown option
            } else if (cleanText.includes('BACK PAPER')) {
                examType = 'BACK EXAM';
            } else if (cleanText.includes('EX-STUDENT')) {
            // --- MODIFICATION END (C) ---
                examType = 'EX-STUDENT EXAM';
            } else {
                const typeMatch = cleanText.match(/COLLEGE\s*EXAMINATION\s*\/\s*([A-Z\s]+)\s*\/\s*(\d+)/i);
                if (typeMatch && typeMatch[1].trim() !== 'ZIND SEMESTER') {
                    const detectedType = typeMatch[1].trim().replace(/\s+/g, ' ');
                    if (detectedType && detectedType !== 'PROVISIONAL ADMIT CARD') {
                        examType = detectedType;
                    }
                }
            }

            // --- 2. INDIVIDUAL NAME EXTRACTION (for Father/Mother fix) ---
            const fatherName = getMatch(/FATHER'?S\s*NAME:[:\-\n\s]*?([\s\S]*?)(?=ENROLLMENT|MOTHER'?S|ROLL|COURSE)/i);
            const motherName = getMatch(/MOTHER'?S\s*NAME:[:\-\n\s]*?([\s\S]*?)(?=DATE\s*OF\s*BIRTH|SEMESTER|ROLL|COURSE)/i);

            let combinedFatherMotherName = '';
            if (fatherName && motherName) {
                combinedFatherMotherName = `${fatherName}/${motherName}`.trim().replace(/\s*\/\s*/g, '/');
            } else {
                combinedFatherMotherName = getMatch(/FATHER'?S\s*[\/\\]?\s*MOTHER'?S\s*NAME:[:\-\n\s]*?([\s\S]*?)(?=ROLL|COURSE|GENDER)/i) || fatherName || motherName;
            }

            // --- 3. COURSE AND GENDER FIX (using non-greedy and lookahead) ---
            const course = getMatch(/COURSE:[:\-\n\s]*?([\s\S]+?)(?=GENDER|COLLEGE\s*NAME|ADMITTED\s*SUBJECT|EXAMINATION)/i) || getMatch(/ADMITTED\s*COURSE:[:\-\n\s]*?([\s\S]+?)(?=ADMITTED\s*SUBJECT|GENDER)/i);

            const gender = getMatch(/GENDER:[:\-\n\s]*?(MALE|FEMALE|OTHER)(?=\s*(?:CASTE|SEMESTER|ROLL|COURSE))/i) ||
                getMatch(/GENDER:[:\-\n\s]*?(MALE|FEMALE|OTHER)/i) || 'FEMALE';

            // --- 4. SEMESTER / YEAR FIX (looking for the specific form field) ---
            const semester = getMatch(/SEMESTER\s*OR\s*YEAR:[:\-\n\s]*?([0-9]+)(?:ST|ND|RD|TH)?/i) || // Specific Exam Form field
                getMatch(/([0-9]+)(?:ST|ND|RD|TH)?\s*SEMESTER/i) ||
                getMatch(/(\d+)'TH/i) ||
                '4'; // Default to 4

            // --- 5. COLLEGE NAME FIX (Non-greedy and robust) ---
            const collegeName =
  getMatch(/COLLEGE\s*NAME:[:\-\n\s]*?([\s\S]*?)(?=EXAMINATION\s*CENTER|SUBJECT|NOTE|PAPER|PAYMENT|DECLARATION)/i) ||
  getMatch(/ADMITTED\s*COLLEGE:[:\-\n\s]*?([\s\S]*?)(?=PAPER|PAYMENT|NOTE|DECLARATION|PROJECT|COURSE|ROLL|GENDER)/i);
            
            // --- FIX: SUBJECT NAME (Exclude 'NOTE' and subsequent text like PAPER) ---
            // Pattern looks for 'SUBJECT:' followed by content, stopping before the next label (NOTE or PAPER).
            const subject =
  getMatch(/SUBJECT:[:\-\n\s]*?([A-Z0-9,\s]+?)(?=NOTE|ADMITTED\s*COLLEGE|PAPER\s*\d+)/i) ||
  getMatch(/ADMITTED\s*SUBJECT[:\-\n\s]*?([A-Z0-9,\s]+?)(?=ADMITTED\s*COLLEGE|NOTE|PAPER\s*\d+)/i);



            return {
                // Updated to use combined logic
                candidateName: getMatch(/CANDIDATE\s*NAME:[:\-\n\s]*?([\s\S]*?)(?=FATHER'?S|ROLL|COURSE)/i) || getMatch(/STUDENT\s*NAME:[:\-\n\s]*?([\s\S]*?)(?=REGISTRATION|FATHER)/i),
                fatherMotherName: combinedFatherMotherName, // FIX: Uses combined extraction
                rollNumber: getMatch(/ROLL\s*NUMBER[:\-\n\s]*?([A-Z0-9]+)/i),
                enrollmentNumber: getMatch(/ENROLLMENT\s*(?:NO|NUMBER|ID)?[:\-\n\s]*?([A-Z0-9]+)/i) || getMatch(/REGISTRATION\s*NUMBER:\s*([A-Z0-9]+)/i) || getMatch(/([M]\d{8})/i),
                course: course, // FIX: Improved pattern
                gender: gender, // FIX: Improved pattern
                semester: semester, // FIX: Improved pattern
                examType: examType, // FIX: Improved logic
                collegeName: collegeName, // FIX: Improved pattern
                examinationCenter: getMatch(/EXAMINATION\s*CENTER:[:\-\n\s]*?([\s\S]*?)(?=SUBJECT|NOTE|PAPER)/i),
                subject: subject, // FIX: Subject extraction improved to exclude NOTE
                papers: extractPapers(text.toUpperCase())
            };
        }

        /**
         * @description Extracts and cleans paper details from the provided text.
         */
        function extractPapers(text) {
            const papers = [];
            // Pattern: PAPER X <CODE> <NAME> <TYPE>
            const regex = /PAPER\s*\d+\s*([A-Z0-9]+)\s*([\s\S]*?)(THEORY|PRACTICAL|PROJECT|MINNOR|VOCATIONAL|CO CURRICULAR|INTERNAL|EXTERNAL)[\s,]*?(INTERNAL|EXTERNAL)?/gi;
            let match;
            
            // Array of words to filter out if they appear as the first word of the paper name
            const filterWords = ['BOTANY', 'SUBJECT', 'VOCATIONAL', 'CO', 'PHYSICS', 'CHEMISTRY', 'MATHEMATICS', 'PRACTICAL:', 'LAB', 'ALGAE,'];

            while ((match = regex.exec(text)) !== null) {
                const rawNameArea = match[2].trim().replace(/[\n\t\r]+/g, ' ').replace(/\s{2,}/g, ' ');
                const code = match[1].trim();
                let type1 = match[3].trim();
                let type2 = match[4] ? match[4].trim() : '';

                // Clean up the raw name area by filtering common subject words
                let nameParts = rawNameArea.split(/\s+/).filter(p => p.length > 0);
                
                // FIX: Loop to remove common subject name (like "BOTANY") from the start of the paper name
                let cleanedNameParts = [];
                let removeNext = true;
                for (const part of nameParts) {
                    if (removeNext && filterWords.includes(part)) {
                        continue; // Skip the word
                    } else {
                        // Once a non-filter word is hit, stop filtering the start
                        removeNext = false;
                        cleanedNameParts.push(part);
                    }
                }
                nameParts = cleanedNameParts;

                // Final cleanup for phrases like 'BOTANY MICROBILOGY' where 'BOTANY' is removed
                let name = nameParts.join(' ');
                
                // If name is empty after stripping, use a fallback
                if(name.length === 0 && code.endsWith('P')) {
                     name = 'PRACTICAL';
                } else if (name.length === 0) {
                    name = 'GENERAL PAPER';
                }

                papers.push({
                    code: code,
                    name: name.toUpperCase(),
                    // Clean up paper type from internal/external mentions that might be repeated
                    type: type1.toUpperCase().replace(/,?\s*EXTERNAL/g, '').replace(/,?\s*INTERNAL/g, '').replace(/\s{2,}/g, ' ')
                });
            }
            
            // Final check: Extracting single paper from Exam Form table (Pattern: CODE NAME TYPE)
            if (papers.length === 0) {
                const singlePaperMatch = text.match(/PAPER\s*1\s*([A-Z0-9]+)\s*([\s\S]+?)(THEORY|PRACTICAL|PROJECT|INTERNAL|EXTERNAL)/i);
                if (singlePaperMatch) {
                    // Try to clean up the name part
                    let name = singlePaperMatch[2].trim().replace(/[\n\t\r]+/g, ' ').replace(/\s{2,}/g, ' ');
                    name = name.replace(/SUBJECT/i, '').trim(); // Remove 'SUBJECT' if present

                    papers.push({
                        code: singlePaperMatch[1].trim(),
                        name: name.toUpperCase(),
                        type: singlePaperMatch[3].trim().toUpperCase()
                    });
                }
            }

            return papers.length ? papers : [{
                code: '',
                name: '',
                type: ''
            }];
        }

        // --- FILL FORM WITH AUTO DATA ---
        function fillFormWithData(data) {
            const set = (id, val) => {
                const el = document.getElementById(id);
                if (el) el.value = val || '';
            };
            set('candidateName', data.candidateName);
            set('fatherMotherName', data.fatherMotherName);
            set('rollNumber', data.rollNumber);
            set('enrollmentNumber', data.enrollmentNumber);
            set('course', data.course);
            // Ensure dropdowns get valid options
            set('gender', ['MALE', 'FEMALE', 'OTHER'].includes(data.gender) ? data.gender : 'FEMALE');
            set('semester', data.semester);
            set('examType', ['MAIN EXAM', 'BACK EXAM', 'EX-STUDENT EXAM'].includes(data.examType) ? data.examType : 'MAIN EXAM');
            set('collegeName', data.collegeName);
            // Fallback for Exam Center if not found on Exam Form (assumes college is center)
            set('examinationCenter', data.examinationCenter || data.collegeName);
            set('subject', data.subject);

            paperEntriesContainer.innerHTML = '';
            if (data.papers.length === 0) {
                addPaperEntry(); // Add one empty row if none found
            } else {
                data.papers.forEach(addPaperEntry);
            }
        }

        // --- UTILITY: SHOW FLOATING MESSAGE (for replacing alert) ---
        function showFloatingMessage(message, classes = 'bg-blue-500') {
            let msgBox = document.getElementById('floating-message');
            if (!msgBox) {
                msgBox = document.createElement('div');
                msgBox.id = 'floating-message';
                msgBox.className = 'fixed top-4 right-4 p-4 rounded-lg text-white shadow-xl transition-opacity duration-300 z-50';
                document.body.appendChild(msgBox);
            }
            msgBox.className = `fixed top-4 right-4 p-4 rounded-lg text-white shadow-xl transition-opacity duration-300 z-50 ${classes}`;
            msgBox.textContent = message;
            msgBox.style.opacity = '1';

            setTimeout(() => {
                msgBox.style.opacity = '0';
            }, 3000);
        }

        /**
         * @description Formats and updates the printed date and time on the admit card.
         */
        function updateDateTime() {
            const now = dayjs();
            const dateStr = now.format('DD-MMM-YYYY'); // e.g., 04-Oct-2025
            const timeStr = now.format('hh:mm:ss A'); // e.g., 09:31:57 PM
            const timezoneStr = now.format('ZZ').replace(/(\d{2})(\d{2})/, '$1:$2'); // e.g., +05:30 (manual formatting for better readability)

            document.getElementById('generatedTime').innerHTML =
                `${dateStr} ${timeStr} IST ${timezoneStr}`;
        }

        /**
         * @description Clears all fields in the manual entry form.
           * @description Clears all fields in the manual entry form.
         */
        function resetForm() {
            document.getElementById('admitCardForm').reset();
            paperEntriesContainer.innerHTML = '';
            addPaperEntry();
            document.getElementById('admit-card-wrapper').style.display = 'none';
            document.getElementById('downloadBtn').style.display = 'none';
            document.getElementById('printBtn').style.display = 'none';
            showFloatingMessage('Form has been reset.', 'bg-red-500');
        }

        /**
         * @description Initiates the native browser print dialogue for the admit card content only.
         */
        function printAdmitCard() {
            window.print();
        }

        /**
         * @description Main function to generate the admit card view.
         */
        function generateAdmitCard() {
            const candidateName = document.getElementById('candidateName').value,
                fatherMotherName = document.getElementById('fatherMotherName').value,
                rollNumber = document.getElementById('rollNumber').value,
                enrollmentNumber = document.getElementById('enrollmentNumber').value,
                course = document.getElementById('course').value,
                gender = document.getElementById('gender').value,
                semester = document.getElementById('semester').value,
                // Detect if the form is for SPECIAL BACK PAPER (a specific requirement)
                rawExamType = document.getElementById('examType').value,
                examType = rawExamType === 'BACK EXAM' ? 'SPECIAL BACK EXAM' : rawExamType,
                // --- MODIFICATION END (A) ---
                collegeName = document.getElementById('collegeName').value,
                examinationCenter = document.getElementById('examinationCenter').value,
                subject = document.getElementById('subject').value;

            // Simple validation
            if (!candidateName || !rollNumber || !course || !examType) {
                showFloatingMessage('Please fill in all required fields.', 'bg-red-700');
                return;
            }

            // Get paper details
            const paperEntries = Array.from(paperEntriesContainer.children).map(div => ({
                code: div.querySelector('input:nth-child(1)').value.toUpperCase() || 'N/A', // Ensure code is at least N/A
                name: div.querySelector('input:nth-child(2)').value.toUpperCase() || 'N/A',
                type: div.querySelector('input:nth-child(3)').value.toUpperCase() || 'N/A',
            }));

            // Build papers table HTML
            let papersHtml = paperEntries.map((paper, index) => {
                const details = examDatesheet[paper.code] || {
                    date: 'SCHEDULE NOT FOUND', // Changed default to better reflect the issue
                    day: 'SCHEDULE NOT FOUND',
                    shift: 'SCHEDULE NOT FOUND'
                };

                let scheduleHTML;
                const paperTypeCleaned = paper.type.toUpperCase().replace(/\s{2,}/g, ' ');

                if (details.date === 'N/A') {
                    // For R/P/Project papers where date is college-decided
                    scheduleHTML = `<td colspan="3" style="text-align: center; font-weight: bold; color: #d32f2f;">Contact the college for exam date (Paper is ${paperTypeCleaned})</td>`;
                } else if (details.date === 'SCHEDULE NOT FOUND') {
                    // For codes not found in the datesheet array
                    scheduleHTML = `<td colspan="3" style="text-align: center; font-weight: bold; color: #f57c00;">Visit ccsuniversity.ac.in to confirm the exam schedule</td>`;
                } else {
                    // Normal entry found
                   // --- MODIFICATION START (B) ---
                    const [shiftName, shiftTime] = details.shift.split('('); // Split "Shift 1 (10:00 AM...)"
                    scheduleHTML = `
                        <td>${details.date}</td>
                        <td>${details.day}</td>
                        <td>
                            ${shiftName.trim()}<br>
                            ${shiftTime ? `(${shiftTime}` : ''}
                        </td>
                    `;
                    // --- MODIFICATION END (B) ---
                }

                return `
                <tr>
                    <td style="text-align: center;">${index + 1}</td> 
                    <td>${paper.code}</td>
                    <td>${paper.name}</td>
                    <td>${paper.type}</td>
                    ${scheduleHTML}
                </tr>`;
            }).join('');

            // Fill the Admit Card HTML
            document.getElementById('ac-rollNumber').textContent = rollNumber.toUpperCase();
            document.getElementById('ac-enrollmentNumber').textContent = enrollmentNumber.toUpperCase();
            document.getElementById('ac-candidateName').textContent = candidateName.toUpperCase();
            document.getElementById('ac-fatherMotherName').textContent = fatherMotherName.toUpperCase();
            document.getElementById('ac-course').textContent = course.toUpperCase();
            document.getElementById('ac-gender').textContent = gender.toUpperCase();
            document.getElementById('ac-collegeName').textContent = collegeName.toUpperCase();
            document.getElementById('ac-examinationCenter').textContent = examinationCenter.toUpperCase();
            document.getElementById('ac-subject').textContent = subject.toUpperCase();
            
            const semesterText = `${semester}${['1','2','3'].includes(semester) ? ['st','nd','rd'][semester-1] : 'th'} SEMESTER`;
            document.getElementById('exam-type-sem').textContent = `${examType} (${semesterText})`;

            const paperTableBody = document.querySelector('#ac-papers-table tbody');
            paperTableBody.innerHTML = papersHtml;

            // Show the admit card and action buttons
            document.getElementById('admit-card-wrapper').style.display = 'block';
            document.getElementById('downloadBtn').style.display = 'inline-block';
            document.getElementById('printBtn').style.display = 'inline-block';
            updateDateTime(); // Update the printed date/time

            // Scroll to the admit card
            document.getElementById('admit-card-wrapper').scrollIntoView({
                behavior: 'smooth'
            });
            showFloatingMessage('Admit Card Generated! 📄', 'bg-green-600');
        }


        // --- DOWNLOAD AS PDF ---
        document.getElementById('downloadBtn').addEventListener('click', () => {
            const element = document.getElementById('admit-card-content');
            const candidateName = document.getElementById('candidateName').value;
            const filename = `${candidateName.replace(/\s/g, '_')}_Admit_Card.pdf`;

            showFloatingMessage('Generating PDF... please wait.', 'bg-yellow-600');

            // Configure PDF generation options for better print quality and A4 size simulation
            const opt = {
                margin: 0.5,
                filename: filename,
                image: {
                    type: 'jpeg',
                    quality: 1
                },
                html2canvas: {
                    scale: 4,
                    letterRendering: true,
                   useCORS: true
                },
                jsPDF: {
                    unit: 'in',
                    format: 'a4',
                    orientation: 'portrait'
                }
            };

            // Use html2pdf to generate and save
            html2pdf().from(element).set(opt).save();

            // The save function is asynchronous, so the message below is only an estimate.
            setTimeout(() => {
                showFloatingMessage('PDF download initiated. 📥', 'bg-green-500');
            }, 500);
        });

        // --- BUTTON EVENT LISTENERS ---
        document.getElementById('generateBtn').addEventListener('click', generateAdmitCard);
        document.getElementById('resetBtn').addEventListener('click', resetForm);
        document.getElementById('printBtn').addEventListener('click', printAdmitCard);
        
        // Mobile Menu Toggle
    document.getElementById('menu-btn').addEventListener('click', () => {
      document.getElementById('mobile-menu').classList.toggle('hidden');
    });
   
    
    </script>
</body>
</html>
