<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Exam Datesheet Portal</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>

body{
font-family:system-ui;
margin:0;
background:#f5f7fb;
}

header{
background:white;
padding:15px;
box-shadow:0 2px 10px rgba(0,0,0,0.05);
position:sticky;
top:0;
z-index:100;
}

h1{
margin:0;
font-size:22px;
}

.tabs{
display:flex;
gap:10px;
margin-top:10px;
overflow:auto;
}

.tab{
padding:8px 14px;
background:#e9eef8;
border-radius:20px;
cursor:pointer;
white-space:nowrap;
}

.tab.active{
background:#4f6ef7;
color:white;
}

.container{
padding:20px;
}

.controls{
display:flex;
gap:10px;
flex-wrap:wrap;
margin-bottom:15px;
}

input,select{
padding:8px;
border-radius:6px;
border:1px solid #ddd;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
gap:15px;
}

.card{
background:white;
border-radius:10px;
padding:15px;
box-shadow:0 3px 12px rgba(0,0,0,0.08);
}

.card h3{
margin-top:0;
color:#4f6ef7;
}

.exam{
border-top:1px solid #eee;
padding:8px 0;
font-size:14px;
}

.badge{
display:inline-block;
padding:3px 8px;
border-radius:5px;
font-size:12px;
background:#eef2ff;
}

@media(max-width:600px){

.controls{
flex-direction:column;
}

}

</style>
</head>

<body>

<header>

<h1>Exam Datesheet</h1>

<div id="courseTabs" class="tabs"></div>

</header>

<div class="container">

<div class="controls">

<input id="searchBox" placeholder="Search subject or code">

<select id="shiftSort">
<option value="">Sort by Shift</option>
<option value="Morning">Morning</option>
<option value="Evening">Evening</option>
</select>

<select id="viewMode">
<option value="date">Date Wise</option>
<option value="dateCourse">Date + Course</option>
<option value="course">Course Wise</option>
</select>

</div>

<div id="content" class="grid"></div>

</div>

<script>

let data=[]
let currentCourse="All"

fetch("DatesheetSeach.xlsx")
.then(r=>r.arrayBuffer())
.then(buffer=>{

let workbook=XLSX.read(buffer)

let sheet=workbook.Sheets[workbook.SheetNames[0]]

data=XLSX.utils.sheet_to_json(sheet)

createCourseTabs()

render()

})

function createCourseTabs(){

let courses=["All",...new Set(data.map(x=>x.Course))]

let container=document.getElementById("courseTabs")

courses.forEach(course=>{

let tab=document.createElement("div")

tab.className="tab"

tab.innerText=course

if(course==="All") tab.classList.add("active")

tab.onclick=()=>{

document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"))

tab.classList.add("active")

currentCourse=course

render()

}

container.appendChild(tab)

})

}

function filterData(){

let filtered=[...data]

if(currentCourse!=="All")

filtered=filtered.filter(x=>x.Course===currentCourse)

let search=document.getElementById("searchBox").value.toLowerCase()

if(search)

filtered=filtered.filter(x=>

Object.values(x).join(" ").toLowerCase().includes(search)

)

let shift=document.getElementById("shiftSort").value

if(shift)

filtered=filtered.filter(x=>x.Shift===shift)

return filtered

}

function groupBy(arr,key){

return arr.reduce((a,v)=>{

(a[v[key]]=(a[v[key]]||[])).push(v)

return a

},{})

}

function render(){

let mode=document.getElementById("viewMode").value

let container=document.getElementById("content")

container.innerHTML=""

let filtered=filterData()

let grouped

if(mode==="date")

grouped=groupBy(filtered,"Date")

if(mode==="course")

grouped=groupBy(filtered,"Course")

if(mode==="dateCourse")

grouped=groupBy(filtered,"Date")

Object.keys(grouped).forEach(key=>{

let card=document.createElement("div")

card.className="card"

let html=`<h3>${key}</h3>`

grouped[key].forEach(exam=>{

html+=`

<div class="exam">

<b>${exam.Subject}</b><br>

<span class="badge">${exam.Course}</span>

<span class="badge">${exam.Shift}</span>

<br>

Code: ${exam.Code}

</div>

`

})

card.innerHTML=html

container.appendChild(card)

})

}

document.getElementById("searchBox").oninput=render
document.getElementById("shiftSort").onchange=render
document.getElementById("viewMode").onchange=render

</script>

</body>
</html>
