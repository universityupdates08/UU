<!DOCTYPE html>  
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MSU NEP Result Calculator (with Grace)</title>
<style>
/* === Header === */
header {
  text-align: center;
  padding: 15px;
  background: linear-gradient(135deg, #fdf8de, #fdf8fe);
  color: white;
  box-shadow: 0 6px 16px rgba(0,0,0,0.35);
  border-radius: 0 0 20px 20px;
}
header img {
  height: 60px;
  margin-bottom: 5px;
  filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.4));
}
header h1 {
  margin: 5px 0;
  font-size: 28px;
  font-weight: bold;
  text-shadow: 2px 2px 6px rgba(0,0,0,0.4);
}
body { 
  font-family: Arial, sans-serif; 
  background: linear-gradient(135deg, #fffde7, #ffffff, #e3f2fd); 
  margin:0; 
  padding:10px; 
}
.tabs { display:flex; justify-content:center; margin:20px 0; gap:10px; }
.tab-btn { 
  background:#fff; 
  border:2px solid #007bff; 
  color:#007bff; 
  padding:10px 20px; 
  margin:0 5px; 
  border-radius:12px; 
  font-weight:bold; 
  cursor:pointer; 
  box-shadow:0 4px 10px rgba(0,123,255,0.2); 
  transition:.3s; 
}
.tab-btn.active { 
  background:#007bff; 
  color:#fff; 
  transform:scale(1.05); 
  box-shadow:0 6px 14px rgba(0,123,255,0.4); 
}
.tab-content { 
  display:none; 
  max-width:900px; 
  margin:auto; 
  background:#ffffff; 
  padding:20px; 
  border-radius:16px; 
  box-shadow:0 6px 20px rgba(0,0,0,0.25); 
  transform:translateY(10px); 
  animation:popup .5s ease-out forwards; 
}
.tab-content.active { display:block; }
@keyframes popup {
  from {opacity:0; transform:scale(0.95);}
  to {opacity:1; transform:scale(1);}
}
.cta, button { 
  padding:10px 18px; 
  border:none; 
  border-radius:10px; 
  background:linear-gradient(135deg,#ffeb3b,#2196f3); 
  color:#333;
  font-weight:600; 
  cursor:pointer; 
  transition:.3s; 
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
}
.cta:hover, button:hover { 
  transform:scale(1.08); 
  box-shadow:0 6px 16px rgba(0,0,0,0.35); 
}
.rules { 
  background:#fdfde7; 
  padding:12px; 
  border:1px solid #ccc; 
  margin:10px 0; 
  border-radius:12px; 
  box-shadow:inset 0 2px 6px rgba(0,0,0,0.1);
}
.subject { display:flex; gap:6px; margin:6px 0; flex-wrap:wrap; }
.subject input, .subject select { padding:5px; border-radius:6px; border:1px solid #ccc; }
.pass{color:green;font-weight:bold;} 
.fail{color:red;font-weight:bold;} 
.grace{color:red;} 
.remark{color:#555; font-style:italic; margin-left:8px;}
.print-btn, .download-btn { margin-top:10px; background:#28a745; color:#fff; }
.print-btn:hover, .download-btn:hover { background:#218838; }
</style>

<!-- Include jsPDF & html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>

<header> 
<img src="https://i.ibb.co/nMC0877T/UNIVERSITY-UPDATES-LOGO-removebg-preview.png" alt="Calculator Logo"> 
</header>

  
<h1 style="text-align:center; color:#0d47a1; text-shadow:1px 1px 4px rgba(0,0,0,0.3);">MSU NEP Result Calculator (with Grace)</h1>

  <style>
/* 3D HD buttons for WhatsApp, Telegram, Contact */
.nav-btn {
  display:inline-block;
  padding:12px 24px;
  margin:5px;
  border:none;
  border-radius:12px;
  background:#0288d1;
  color:white;
  font-weight:bold;
  cursor:pointer;
  box-shadow: 0 8px 20px rgba(0,0,0,0.25), 0 4px 8px rgba(0,0,0,0.15);
  transition: transform 0.3s, box-shadow 0.3s;
  text-decoration:none;
}
.nav-btn:hover {
  transform: translateY(-3px) scale(1.05);
  box-shadow: 0 12px 28px rgba(0,0,0,0.35), 0 6px 12px rgba(0,0,0,0.2);
}
</style>

<!-- Replace your nav buttons with -->
<nav style="text-align:center; display:flex; justify-content:center; gap:12px; margin-bottom:20px;">
  <a href="https://whatsapp.com/channel/0029Va4irjP23n3Vh4HMcx00" class="nav-btn">WhatsApp</a>
  <a href="https://t.me/myMSUSre" class="nav-btn">Telegram</a>
  <a href="https://t.me/HELPforDmbot" class="nav-btn">Contact</a>
</nav>

<main class="container">
  <div style="text-align: center; margin: 20px 0; color:#007bff; font-size:15px;">
    <b>Note:</b> This is not an Official Website of <b>Maa Shakumbhari University, Saharanpur</b>.  
    "This is for information purposes only. Errors in result calculation are possible."
  </div>
  
  <div style="text-align: center; margin: 20px 0; color:#DD511D; font-size:15px;">    
    <b>"‡§ó‡•ç‡§∞‡•á‡§∏ ‡§®‡§ø‡§Ø‡§Æ ‡§ï‡•á‡§µ‡§≤ ‡§¶‡§ø‡§∏‡§Ç‡§¨‡§∞ - 2024 ‡§è‡§µ‡§Ç ‡§ú‡•Ç‡§® - 2025 ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ‡§ì ‡§™‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§π‡•ã‡§ó‡§æ‡•§"</b>
  </div>
  
<div style="text-align: center; margin: 20px auto; max-width:800px; 
            padding:20px; border-radius:16px; 
            background:linear-gradient(135deg, #fdf8de, #fdf8fe); 
            box-shadow: 0 12px 25px rgba(0,0,0,0.2), 0 6px 12px rgba(0,0,0,0.15);
            transform: perspective(500px) rotateX(1deg) rotateY(-1deg); 
            transition: transform 0.3s;">
  <h2 style="font-size: 20px; font-weight: bold; color: #2c3e50; 
             text-shadow: 1px 1px 4px rgba(0,0,0,0.15); margin-bottom:10px;">
    Meet Our <span style="color:#0288d1;">Admin Team</span>
  </h2>
  <p style="font-size: 16px; color: #555; text-shadow:0.5px 0.5px 2px rgba(0,0,0,0.1);">
    <b>Aditya Chaudhary</b> (Owner) | <b>Chetan Joshi</b> (Co-Owner) | <b>DM, PC, AP, AM, GS</b> (Admin Team)
  </p>
</div>


  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" onclick="openTab('ugTab',event)">UG (B.A./B.Sc./B.Com)</button>
    <button class="tab-btn" onclick="openTab('pgTab',event)">PG (M.A./M.Sc./M.Com)</button>
  </div>

  <!-- UG Section -->
  <div class="tab-content active" id="ugTab">
    <h2>UG NEP Result Calculator</h2>
    <div class="rules">
      <ul>
        <h3><b>Rules</b></h3>
        <li>Maximum 5 grace marks</li>
        <li>Grace in maximum 2 subjects</li>
        <li>Grace Marks will be given in <b>External Theory & Co-Curricular</b> only</li>
        <li>No Grace in Practical/Skill Development/Viva/Project</li>
        <li>Passing: Major/Minor = 25 External & 33 Total</li>
        <li>Passing: Skill/Project/Co-Curricular = 40 Total</li>
      </ul>
    </div>
    <div id="ug-subjects"></div>
    <button onclick="addSubjectUG()">‚ûï Add Subject</button>
    <button onclick="calculateUG()">üìä Calculate UG Result</button>
    <div id="ug-result"></div>
  </div>

  <!-- PG Section -->
  <div class="tab-content" id="pgTab">
    <h2>PG NEP Result Calculator</h2>
    <div class="rules">
      <ul>
        <h3><b>Rules</b></h3>
        <li>Maximum 5 grace marks</li>
        <li>Grace in maximum 2 subjects</li>
        <li>Maximum 3 grace per subject</li>
        <li>Grace Marks will be given in <b>External Theory</b> only</li>
        <li>No Grace in Practical/Viva/Project</li>
        <li>Passing: Major/Minor = 25 External & 40 Total</li>
        <li>Passing: Project = 40 Total</li>
      </ul>
    </div>
    <div id="pg-subjects"></div>
    <button onclick="addSubjectPG()">‚ûï Add Subject</button>
    <button onclick="calculatePG()">üìä Calculate PG Result</button>
    <div id="pg-result"></div>
  </div>

  <div style="text-align:center; margin:20px 0;">
    <div id="note" style="font-weight:bold; color:#0d47a1;">This result is only for information purpose. Not valid for admission or official use.</div>
  </div>

</main>

<footer style="text-align:center; margin:20px 0; font-weight:bold; color:#007bff;">
  ¬© 2025 | Designed by <b>Aditya Chaudharyüíó</b>
</footer>

<script>
// === TAB SWITCH ===
function openTab(tabId,evt){
  document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
  document.querySelectorAll(".tab-content").forEach(c=>c.classList.remove("active"));
  evt.target.classList.add("active");
  document.getElementById(tabId).classList.add("active");
}

// === ADD SUBJECTS ===
function addSubjectUG(){
  const div=document.createElement("div");
  div.className="subject";
  div.innerHTML=`Name:<input type="text" placeholder="Subject">
                 Ext:<input type="number" min="0" max="75">
                 Int:<input type="number" min="0" max="25">
                 Type:<select>
                   <option value="theory">Theory</option>
                   <option value="practical">Practical</option>
                   <option value="project">Project</option>
                   <option value="skill">Skill Development</option>
                   <option value="cocurricular">Co-Curricular</option>
                 </select>
                 <button onclick="this.parentElement.remove()" style="background:#dc3545;color:white;">X</button>`;
  document.getElementById("ug-subjects").appendChild(div);
}
function addSubjectPG(){
  const div=document.createElement("div");
  div.className="subject";
  div.innerHTML=`Name:<input type="text" placeholder="Subject">
                 Ext:<input type="number" min="0" max="75">
                 Int:<input type="number" min="0" max="25">
                 Type:<select>
                   <option value="theory">Theory</option>
                   <option value="practical">Practical</option>
                   <option value="project">Project</option>
                 </select>
                 <button onclick="this.parentElement.remove()" style="background:#dc3545;color:white;">X</button>`;
  document.getElementById("pg-subjects").appendChild(div);
}

// === DOWNLOAD PDF FUNCTION ===
function downloadPDF(printableId){
  const { jsPDF } = window.jspdf;
  const element = document.getElementById(printableId);

  html2canvas(element, { scale: 2 }).then(canvas => {
    const imgData = canvas.toDataURL('image/png');
    const pdf = new jsPDF('p', 'pt', 'a4');
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
    pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
    pdf.save('MSU_Result.pdf');
  });
}

// === COMMON RENDER FUNCTION WITH DOWNLOAD BUTTON ===
function renderResult(containerId, subjects, overallPass, passCount, failCount, totalGrace, subjectsUsed){
  if(subjects.length===0){
    document.getElementById(containerId).innerHTML=
      `<p style="color:red; font-weight:bold;">‚ö† Please add at least one subject to calculate result.</p>`;
    return;
  }

  let now = new Date();
  let dateTime = now.toLocaleString();

  let resultHTML = `
    <div id="printable-${containerId}" style="padding:10px; background:#f9f9f9;">
      <div style="text-align:center; margin-bottom:10px;">
        <img src="https://i.ibb.co/nMC0877T/UNIVERSITY-UPDATES-LOGO-removebg-preview.png" 
             alt="Logo" style="height:60px; margin-bottom:5px; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.4));">
        <div><b>Date & Time:</b> ${dateTime}</div>
      </div>
      <div style="overflow-x:auto;">
      <table border="1" style="margin-top:10px; border-collapse:collapse; width:100%; text-align:center; 
                                box-shadow:0 4px 14px rgba(0,0,0,0.25); border-radius:12px; overflow:hidden;">
        <tr style="background:linear-gradient(135deg,#89f7fe,#66a6ff); color:white; text-shadow:1px 1px 2px rgba(0,0,0,0.4);">
          <th>Subject</th><th>External</th><th>Grace</th><th>External after Grace</th>
          <th>Internal</th><th>Total</th><th>Status</th><th>Remarks</th>
        </tr>`;

  subjects.forEach(s=>{
    resultHTML+=`
      <tr style="background:${s.passed?'#e8f5e9':'#ffebee'}; font-weight:bold; box-shadow:inset 0 1px 3px rgba(0,0,0,0.1);">
        <td>${s.name}</td><td>${s.originalExt}</td><td>${s.graceGiven>0?s.graceGiven:"-"}</td>
        <td>${s.ext}</td><td>${s.inte}</td><td>${s.total}</td>
        <td>${s.passed?"<span class='pass'>PASS</span>":"<span class='fail'>FAIL</span>"}</td>
        <td style="color:${s.remarks.includes("Cancelled")||s.remarks.includes("Fail")?"red":"green"};">
          ${s.remarks}
        </td>
      </tr>`;
  });

  resultHTML+=`<tr style="font-weight:bold; background:#f1f8ff;">
      <td colspan="8">Final Result: ${overallPass?"<span class='pass'>PASS</span>":"<span class='fail'>FAIL</span>"} |
      Total Subjects: ${subjects.length}, Passed: ${passCount}, Failed: ${failCount},
      Grace Used: ${totalGrace} (in ${subjectsUsed} subject${subjectsUsed!==1?"s":""})</td>
    </tr>
    </table>
    </div>
    <div style="text-align:center; margin-top:10px;">
      <button class="download-btn" onclick="downloadPDF('printable-${containerId}')">‚¨áÔ∏è Download PDF</button>
    </div>
  </div>`;

  document.getElementById(containerId).innerHTML = resultHTML;
}

// === UG LOGIC ===
function calculateUG(){
  const subs=document.querySelectorAll("#ug-subjects .subject");
  if(subs.length===0){
    document.getElementById("ug-result").innerHTML=
      `<p style="color:red; font-weight:bold;">‚ö† Please add at least one subject to calculate result.</p>`;
    return;
  }

  let subjectsData=[];
  let totalGrace=0, subjectsUsed=0, passCount=0, failCount=0;

  subs.forEach(s=>{
    const name=s.querySelector("input[type=text]").value||"Subject";
    let ext=parseInt(s.querySelectorAll("input")[1].value)||0;
    let inte=parseInt(s.querySelectorAll("input")[2].value)||0;
    const type=s.querySelector("select").value;

    let total=ext+inte, passed=false, graceGiven=0, remarks="", originalExt=ext;
    let need=0;

    if(type==="theory"){
      if(ext>=25 && total>=33){ passed=true; passCount++; }
      else {
        need=Math.max(25-ext,33-total);
        if(need>0 && need<=5){ ext+=need; total+=need; graceGiven=need; }
      }
      if(!passed) remarks=`Fail: Need ${need} more marks in External/Total`;

    } else if(type==="practical"){
      if(ext>=25 && total>=33){ passed=true; passCount++; }
      else { remarks="Fail: Practical needs 25 External & 33 Total"; }

    } else if(type==="cocurricular"){
      if(total>=40){ passed=true; passCount++; }
      else {
        need=40-total;
        if(need>0 && need<=5){ ext+=need; total+=need; graceGiven=need; }
      }
      if(!passed) remarks=`Fail: Need ${need} more marks in Co-Curricular`;

    } else { 
      if(total>=40){ passed=true; passCount++; }
      else { remarks="Fail: Total <40"; }
    }

    if(graceGiven>0){ totalGrace+=graceGiven; subjectsUsed++; if(ext>=25 && total>=33 && type!=="cocurricular") passed=true; if(type==="cocurricular" && total>=40) passed=true; if(passed) passCount++; }
    if(!passed) failCount++;

    subjectsData.push({name,ext,inte,total,passed,graceGiven,remarks,originalExt});
  });

  if(totalGrace>5 || subjectsUsed>2){
    subjectsData.forEach(sd=>{
      if(sd.graceGiven>0){
        sd.ext=sd.originalExt;
        sd.total=sd.originalExt+sd.inte;
        sd.passed=false;
        sd.remarks=`Grace Cancelled (Not Eligible). Need ${Math.max(25-sd.originalExt,33-sd.total)} more marks in External`;
        sd.graceGiven="-";
      }
    });
    passCount=subjectsData.filter(s=>s.passed).length;
    failCount=subjectsData.length-passCount;
    totalGrace=0; subjectsUsed=0;
  }

  renderResult("ug-result",subjectsData,failCount===0,passCount,failCount,totalGrace,subjectsUsed);
}

// === PG LOGIC ===
function calculatePG(){
  const subs=document.querySelectorAll("#pg-subjects .subject");
  if(subs.length===0){
    document.getElementById("pg-result").innerHTML=
      `<p style="color:red; font-weight:bold;">‚ö† Please add at least one subject to calculate result.</p>`;
    return;
  }

  let subjectsData=[];
  let totalGrace=0, subjectsUsed=0, passCount=0, failCount=0;

  subs.forEach(s=>{
    const name=s.querySelector("input[type=text]").value||"Subject";
    let ext=parseInt(s.querySelectorAll("input")[1].value)||0;
    let inte=parseInt(s.querySelectorAll("input")[2].value)||0;
    const type=s.querySelector("select").value;

    let total=ext+inte, passed=false, graceGiven=0, remarks="", originalExt=ext;
    let need=0;

    if(type==="theory"){
      if(ext>=25 && total>=40){ passed=true; passCount++; }
      else {
        need=Math.max(25-ext,40-total);
        if(need>0 && need<=3){ ext+=need; total+=need; graceGiven=need; }
      }
      if(!passed) remarks=`Fail: Need ${need} more marks in External/Total`;
    } else {
      if(total>=40){ passed=true; passCount++; }
      else { remarks="Fail: Total <40"; }
    }

    if(graceGiven>0){ totalGrace+=graceGiven; subjectsUsed++; if(ext>=25 && total>=40) passed=true; if(passed) passCount++; }
    if(!passed) failCount++;

    subjectsData.push({name,ext,inte,total,passed,graceGiven,remarks,originalExt});
  });

  if(totalGrace>5 || subjectsUsed>2){
    subjectsData.forEach(sd=>{
      if(sd.graceGiven>0){
        sd.ext=sd.originalExt;
        sd.total=sd.originalExt+sd.inte;
        sd.passed=false;
        sd.remarks=`Grace Cancelled (Not Eligible). Need ${Math.max(25-sd.originalExt,40-sd.total)} more marks in External`;
        sd.graceGiven="-";
      }
    });
    passCount=subjectsData.filter(s=>s.passed).length;
    failCount=subjectsData.length-passCount;
    totalGrace=0; subjectsUsed=0;
  }

  renderResult("pg-result",subjectsData,failCount===0,passCount,failCount,totalGrace,subjectsUsed);
}
</script>

</body>
</html>
